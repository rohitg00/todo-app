import { expose } from '@teambit/worker';
import { startVitest } from 'vitest/node';
import WatchReporter from './watch-reporter.js';
export class VitestWorker {
    onTestComplete(onTestComplete) {
        this.onTestCompleteCb = onTestComplete;
    }
    async watch(viteConfig) {
        // eslint-disable-next-line no-param-reassign
        viteConfig.test.reporters = [
            new WatchReporter(async (files, errors) => {
                if (this.onTestCompleteCb) {
                    this.onTestCompleteCb(files, errors);
                }
            })
        ];
        await startVitest('test', undefined, undefined, viteConfig);
    }
}
expose(new VitestWorker());
//# sourceMappingURL=vitest.worker.js.map